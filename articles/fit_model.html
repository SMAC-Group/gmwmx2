<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate a model • gmwmx2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmwmx2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/load_plot_data_ngl.html">Load and plot data from the Nevada Geodetic Laboratory</a>
    </li>
    <li>
      <a href="../articles/fit_model.html">Estimate a model</a>
    </li>
    <li>
      <a href="../articles/estimate_small_network.html">Estimate a small network of GNSS station</a>
    </li>
    <li>
      <a href="../articles/plot_large_network.html">Plot a large network of GNSS station</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SMAC-Group/gmwmx2" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimate a model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SMAC-Group/gmwmx2/blob/main/vignettes/fit_model.Rmd" class="external-link"><code>vignettes/fit_model.Rmd</code></a></small>
      <div class="hidden name"><code>fit_model.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="model-and-estimator">Model and estimator<a class="anchor" aria-label="anchor" href="#model-and-estimator"></a>
</h2>
<p>The <code>gmwmx2</code> <code>R</code> package allows to estimate
linear model with correlated residuals in presence of missing data.</p>
<p>More precisely, we assume the following model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐘</mi><mo>=</mo><mi>𝐗</mi><mi>𝛃</mi><mo>+</mo><mi>𝛆</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>𝛆</mi><mo>∼</mo><mi>ℱ</mi><mrow><mo stretchy="true" form="prefix">{</mo><mi>𝚺</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
    \boldsymbol{Y} = \boldsymbol{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon}, \quad \boldsymbol{\varepsilon} \sim \mathcal{F}\left\{\boldsymbol{\Sigma}\left(\boldsymbol{\gamma}\right)\right\},
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐗</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{X} \in \mathbb{R}^{n \times p}</annotation></semantics></math>
is a design matrix of observed predictors,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛃</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta} \in \mathbb{R}^p</annotation></semantics></math>
is the regression parameter vector and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛆</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ε</mi><mi>i</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\varepsilon} = \{\varepsilon_{i}\}_{i=1,\ldots,n}</annotation></semantics></math>
is a zero-mean process following an unspecified joint distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℱ</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math>
with positive-definite covariance function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝚺</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\Sigma}(\boldsymbol{\gamma}) \in \mathbb{R}^{n\times n}</annotation></semantics></math>
characterizing the second-order dependence structure of the process and
parameterized by the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛄</mi><mo>∈</mo><mi>𝚪</mi><mo>⊂</mo><msup><mi>ℝ</mi><mi>q</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\gamma} \in \boldsymbol{\Gamma} \subset \mathbb{R}^q</annotation></semantics></math>.</p>
<p>We then define the a random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐙</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>i</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{Z} =\{Z_{i}\}_{i=1,\ldots,n}</annotation></semantics></math>
which describes the missing observation mechanism. More specifically,
the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐙</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false" form="postfix">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{Z} \in \{0, 1\}^n</annotation></semantics></math>
is a binary-valued stationary process independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐘</mi><annotation encoding="application/x-tex">\boldsymbol{Y}</annotation></semantics></math>
with expectation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛝</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Z</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mspace width="0.167em"></mspace><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mu(\boldsymbol{\vartheta}) = \mathbb{E}[Z_i] \in [0, \, 1)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∀</mo><mspace width="0.167em"></mspace><mi>i</mi></mrow><annotation encoding="application/x-tex">\forall \, i</annotation></semantics></math>,
and covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝚲</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛝</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>𝐙</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\Lambda}(\boldsymbol{\vartheta}) = \mathbb{V}[\boldsymbol{Z}] \in \mathbb{R}^{n\times n}</annotation></semantics></math>
whose structure is assumed known up to the parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛝</mi><mo>∈</mo><mi>𝚼</mi><mo>⊂</mo><msup><mi>ℝ</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\vartheta} \in \boldsymbol{\Upsilon} \subset \mathbb{R}^k</annotation></semantics></math></p>
<p>We then assume that we only observe the stochastic process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐘</mi><mo accent="true">̃</mo></mover><mo>=</mo><mi>𝐙</mi><mo>⊙</mo><mi>𝐘</mi></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{Y}} = \boldsymbol{Z} \odot \boldsymbol{Y}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⊙</mo><annotation encoding="application/x-tex">\odot</annotation></semantics></math>
denotes the Hadamard product. Hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐘</mi><mo accent="true">̃</mo></mover><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup><mo>=</mo><mi>𝐘</mi><mo>⊙</mo><mi>𝐙</mi></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{Y}} \in \mathbb{R}^n = \boldsymbol{Y} \odot \boldsymbol{Z}</annotation></semantics></math>
represents the observed process vector with null elements in the
positions where observations are missing.</p>
<p>Using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⊗</mo><annotation encoding="application/x-tex">\otimes</annotation></semantics></math>
to denote the Kronecker product, we then define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo>=</mo><mi>𝐙</mi><mo>⊗</mo><msup><mn>𝟏</mn><mi>T</mi></msup><mo>⊙</mo><mi>𝐗</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\tilde{\boldsymbol{X}} = \boldsymbol{Z} \otimes \boldsymbol{1}^T \odot \boldsymbol{X} \in \mathbb{R}^{n \times p}</annotation></semantics></math>
as the design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>
with zero-valued vectors for the rows where observations are missing in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐘</mi><annotation encoding="application/x-tex">\boldsymbol{Y}</annotation></semantics></math>
(where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>𝟏</mn><annotation encoding="application/x-tex">\boldsymbol{1}</annotation></semantics></math>
represents a vector of ones of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>).</p>
<p>We estimate the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛃</mi><annotation encoding="application/x-tex">\boldsymbol{\beta}</annotation></semantics></math>
with the least square estimator:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mi>T</mi></msup><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mi>T</mi></msup><mover><mi>𝐘</mi><mo accent="true">̃</mo></mover><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
    \hat{\boldsymbol{\beta}} = \left(\tilde{\boldsymbol{X}}^T \tilde{\boldsymbol{X}}\right)^{-1} \tilde{\boldsymbol{X}}^T \tilde{\boldsymbol{Y}}.
\end{equation}</annotation></semantics></math></p>
<p>We compute the estimated residuals as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝛆</mi><mo accent="true">̂</mo></mover><mo>=</mo><mover><mi>𝐘</mi><mo accent="true">̃</mo></mover><mo>−</mo><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\varepsilon}} = {\tilde{\boldsymbol{Y}}} - \tilde{{\boldsymbol{X}}} \hat{\boldsymbol{\beta}}</annotation></semantics></math>.</p>
<p>We then estimate with the Maximum Likelihood Estimator the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛝</mi><annotation encoding="application/x-tex">\boldsymbol{\vartheta}</annotation></semantics></math>
of the missingness process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\boldsymbol{Z}</annotation></semantics></math>
assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\boldsymbol{Z}</annotation></semantics></math>
is generated from a Markov model with the following transition
probabilities:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mo>∣</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mo>∣</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mo>∣</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mo>∣</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>2</mn></msub><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
    \label{eq:markov_model_def}
    \begin{aligned}
&amp; P\left( Z_2=1 \mid Z_1=1\right)=1 - p_1 \\
&amp; P\left(Z_2=1 \mid Z_1=0\right) = p_2 \\
&amp; P\left(Z_2=0 \mid Z_1=1\right)=p_1 \\
&amp; P\left(Z_2=0 \mid Z_1=0\right)=1-p_2.
\end{aligned}
\end{equation}</annotation></semantics></math></p>
<p>We then estimate the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
using a Generalized method of Wavelet Moments approach <span class="citation">(Guerrier et al. 2013)</span> and using the fact that
the variance-covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛆</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\varepsilon}}</annotation></semantics></math>
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚺</mi><mover><mi>𝛆</mi><mo accent="true">̂</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>𝚲</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛝</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>μ</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛝</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mn>𝟏</mn><msup><mn>𝟏</mn><mi>T</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>⊙</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐈</mi><mo>−</mo><mi>𝐏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>𝚺</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐈</mi><mo>−</mo><mi>𝐏</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\Sigma}_{\hat{\boldsymbol{\varepsilon}}}(\boldsymbol{\gamma}) = [\boldsymbol{\Lambda}(\hat{\boldsymbol{\vartheta}}) + \mu(\hat{\boldsymbol{\vartheta}})^2 \mathbf{1} \mathbf{1}^T ] \odot ( \boldsymbol{I} - \boldsymbol{P})\boldsymbol{\Sigma}(\boldsymbol{\gamma}) (\boldsymbol{I} - \boldsymbol{P})</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐏</mi><mo>=</mo><mi>𝐗</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝐗</mi><mi>T</mi></msup><mi>𝐗</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>𝐗</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{P} = \boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐈</mi><annotation encoding="application/x-tex">\boldsymbol{I}</annotation></semantics></math>
is the identity matrix of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math>.</p>
<p>More precisely, we rely on the result of <span class="citation">Xu et
al. (2017)</span> that provide a computationally efficient form of the
theoretical Allan variance (equivalent to the Haar wavelet variance up
to a constant) for zero-mean stochastic processes such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛆</mi><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}</annotation></semantics></math>
to avoid computing these large matrices multiplication in the objective
function. Indeed in <span class="citation">Xu et al. (2017)</span> they
generalize the results in <span class="citation">Zhang (2008)</span> to
zero-mean non-stationary processes by using averages of the diagonals
and super-diagonals of the covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛆</mi><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}</annotation></semantics></math>.
What this implies is that the GMWM, which uses this form, does not
require the storage of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math>
covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛆</mi><annotation encoding="application/x-tex">\boldsymbol{\varepsilon}</annotation></semantics></math>,
but only of a vector of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
which is then plugged into an explicit formula consisting in a linear
combination of the elements of this vector (these elements being
averages of the diagonal and super-diagonals of the covariance
matrix).</p>
</div>
<div class="section level2">
<h2 id="estimating-tectonic-velocities-and-crustal-uplift">Estimating tectonic velocities and crustal uplift<a class="anchor" aria-label="anchor" href="#estimating-tectonic-velocities-and-crustal-uplift"></a>
</h2>
<p>While the GMWMX as described above and in more details in <span class="citation">Voirol et al. (2024)</span>, is a general method for
estimating large linear model with complex dependence structure in
presence of missing data, the <code>gmwmx2</code> <code>R</code> package
is currently developed specifically to estimate tectonic velocities from
position times series in graticule distance coordinates system (GD)
provided by the Nevada geodetic Laboratory <span class="citation">(Blewitt 2024; Blewitt, Hammond, and Kreemer
2018)</span>.</p>
<div class="section level3">
<h3 id="trajectory-model">Trajectory model<a class="anchor" aria-label="anchor" href="#trajectory-model"></a>
</h3>
<p>To estimate the trajectory model (see e.g., <span class="citation">Bevis and Brown (2014)</span> for more details), we
construct the design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
component of the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐗</mi><mi>𝛃</mi></mrow><annotation encoding="application/x-tex">\mathbf{X} {{\boldsymbol{\beta}}}</annotation></semantics></math>
can be described as follows with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
representing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
ordered time point (epoch) indicated in Modified Julian Date and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>
representing the reference epoch located exactly in the middle of start
and end point of the time series:</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>𝐘</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>𝐗</mi><mi>i</mi><mi>T</mi></msubsup><mi>𝛃</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>a</mi><mo>+</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>h</mi></msub><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>π</mi><msub><mi>f</mi><mi>h</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>d</mi><mi>h</mi></msub><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>π</mi><msub><mi>f</mi><mi>h</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>r</mi></munderover><msub><mi>e</mi><mi>j</mi></msub><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>s</mi></munderover><msub><mi>l</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>τ</mi><mi>k</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>τ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}
 \mathbb{E}[\mathbf{Y}_i] &amp;= \mathbf{X}_i^T {{\boldsymbol{\beta}}}  \\
&amp;= a + b \left(t_{i} - t_0\right) +  \sum_{h=1}^{m}\left[c_{h} \sin \left(2 \pi f_{h} t_{i}\right)  + d_h \cos \left(2 \pi f_h t_i\right)\right] + \\&amp; \sum_{j=1}^{r}e_j H\left(t_i - t_j\right) + \sum_{k = 1 }^{s} l_k \left[1- \exp\left(\frac{-(t_i-t_k)}{\tau_k}\right)\right]H\left(t_{i}-\tau_k\right) 
\end{split}</annotation></semantics></math><p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the initial position at the reference epoch
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the velocity parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>h</mi></msub><annotation encoding="application/x-tex">c_h</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>h</mi></msub><annotation encoding="application/x-tex">d_h</annotation></semantics></math>
are the periodic motion parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">h = 2</annotation></semantics></math>
represent the annual and semi-annual seasonal terms, respectively with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mfrac><mn>1</mn><mn>365.25</mn></mfrac></mrow><annotation encoding="application/x-tex">f_1 = \frac{1}{365.25}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo>=</mo><mfrac><mn>2</mn><mn>365.25</mn></mfrac></mrow><annotation encoding="application/x-tex">f_2 = \frac{2}{365.25}</annotation></semantics></math>).
The offset terms models earthquakes, equipment changes or human
intervention in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>j</mi></msub><annotation encoding="application/x-tex">e_j</annotation></semantics></math>
is the magnitude of the step at epochs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the total number of offsets,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is the Heaviside step function defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>x</mi><mo>≥</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>x</mi><mo>&lt;</mo><mn>0</mn></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">H(x):= \begin{cases}1, &amp; x \geq 0 \\ 0, &amp; x&lt;0\end{cases}</annotation></semantics></math>
and the last term allow to model post-seismic deformation (see e.g.,
<span class="citation">Sobrero et al. (2020)</span>) where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is the number of post seismic relaxation time specified,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>
is the time when the relaxation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
starts in Modified Julian Date (MJD),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\tau_k</annotation></semantics></math>
is the relaxation period in days for the post-seismic relaxation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mi>k</mi></msub><annotation encoding="application/x-tex">l_k</annotation></semantics></math>
is the amplitude of the transient. Note that by default the estimates of
the functional parameters are provided in unit/day.</p>
<p>When loading data from a specific station using the function
<code><a href="../reference/download_station_ngl.html">gmwmx2::download_station_ngl()</a></code>, we extract from the Nevada
Geodetic Laboratory the position time series in GD coordinates, the time
steps associated with a equipment or software change and the time steps
associated with an earthquake near the station. All these objects are
stored in a object of class <code>gnss_ts_ngl</code>.</p>
<p>When applying the function <code><a href="../reference/gmwmx2.html">gmwmx2::gmwmx2()</a></code> to an object
of class <code>gnss_ts_ngl</code>, we construct the design matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>
by considering an offset term for all equipment or software changes
steps and all earthquakes indicated by the NGL. We also specify a
post-seismic relaxation term for all earthquakes indicated by the NGL.
If no relaxation time is specified in the argument
<code>vec_earthquakes_relaxation_time</code>, we consider a default
relaxation time of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>365.25</mn><annotation encoding="application/x-tex">365.25</annotation></semantics></math>
days.</p>
</div>
<div class="section level3">
<h3 id="stochastic-model">Stochastic model<a class="anchor" aria-label="anchor" href="#stochastic-model"></a>
</h3>
<p>It is generally recognized that noise in GNSS time series is best
described by a combination of colored noise plus white noise <span class="citation">(He et al. 2017; Langbein 2008; Williams et al. 2004;
Bos et al. 2013)</span> where the white noise generally model noise at
high frequencies and the colored noise model the lower frequencies of
the spectrum. In a large study on the noise properties of GNSS signals,
concluded that the optimal noise models for 80–90% of GNSS time series
signals are the power law and white noise model or white noise and
flicker/pink noise with model. The package currently support both
stochastic model specification.</p>
<p>More precisely, the power spectrum of a power-law noise has the
following form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>P</mi><mn>0</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mi>/</mi><msub><mi>f</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>κ</mi></msup></mrow><annotation encoding="application/x-tex">
P(f)=P_0\left(f / f_s\right)^\kappa
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
is the frequency,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mn>0</mn></msub><annotation encoding="application/x-tex">P_0</annotation></semantics></math>
is a constant,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>s</mi></msub><annotation encoding="application/x-tex">f_s</annotation></semantics></math>
the sampling frequency and the exponent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
is called the spectral index.</p>
<p>Many stochastic noise can be expressed as such, for example, a
spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\kappa=0</annotation></semantics></math>
produces a white noise, a spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\kappa=-2</annotation></semantics></math>
produces a red noise or random walk and a spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa=-1</annotation></semantics></math>
produce a flicker noise, also called pink noise.</p>
<p><span class="citation">Granger (1980)</span> and <span class="citation">Hosking (1981)</span> showed that power-law noise with
a spectral index between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
can be obtained by using fractional differencing of Gaussian noise:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>κ</mi><mi>/</mi><mn>2</mn></mrow></msup><mi>𝐯</mi></mrow><annotation encoding="application/x-tex">
(1-B)^{-\kappa / 2} \mathbf{v}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is the backward-shift operator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><msub><mi>v</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\left(B v_i=v_{i-1}\right)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐯</mi><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math>
a vector with independent and identically distributed (IID) Gaussian
noise.</p>
<p>Following from Hosking’s definition of the fractional differencing,
we obtain</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>κ</mi><mi>/</mi><mn>2</mn></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mo accent="false">∞</mo></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mrow><mo>−</mo><mi>κ</mi><mi>/</mi><mn>2</mn></mrow><mi>i</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>i</mi></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mi>κ</mi><mn>2</mn></mfrac><mi>B</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mfrac><mi>κ</mi><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><mi>κ</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>B</mi><mn>2</mn></msup><mo>+</mo><mi>…</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mo accent="false">∞</mo></munderover><msub><mi>h</mi><mi>i</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
(1-B)^{-\kappa / 2} &amp; =\sum_{i=0}^{\infty}\binom{-\kappa / 2}{i}(-B)^i \\
&amp; =1-\frac{\kappa}{2} B-\frac{1}{2} \frac{\kappa}{2}\left(1-\frac{\kappa}{2}\right) B^2+\ldots \\
&amp; =\sum_{i=0}^{\infty} h_i
\end{aligned}
</annotation></semantics></math> with the coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>i</mi></msub><annotation encoding="application/x-tex">h_i</annotation></semantics></math>
that can be computed using the following recurrence relation <span class="citation">(Kasdin and Walter 1992)</span>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>h</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>h</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>−</mo><mfrac><mi>κ</mi><mn>2</mn></mfrac><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><msub><mi>h</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mi>i</mi></mfrac><mspace width="1.0em"></mspace><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
h_0 &amp; =1 \\
h_i &amp; =\left(i-\frac{\kappa}{2}-1\right) \frac{h_{i-1}}{i} \quad \text { for } i&gt;0
\end{aligned}
</annotation></semantics></math></p>
<p>Assuming an infinite sequence of zero-mean white noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐯</mi><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math>,
with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>P</mi><mi>L</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_{P L}^2</annotation></semantics></math>,
and a spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>a</mi><mi>p</mi><mi>p</mi><mi>a</mi><mo>&gt;</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">kappa &gt; -1</annotation></semantics></math>
then the autocovariance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>Cov</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>,</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>+</mo><mi>τ</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>+</mo><mi>τ</mi></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma(\tau)=\operatorname{Cov}\left(X_t, X_{t+\tau}\right)=\mathbb{E}\left[\left(X_t-\mu\right)\left(X_{t+\tau}-\mu\right)\right]</annotation></semantics></math>
is <span class="citation">(Bos et al. 2008)</span>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>σ</mi><mrow><mi>p</mi><mi>l</mi></mrow><mn>2</mn></msubsup><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><mi>α</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mfrac><mi>α</mi><mn>2</mn></mfrac><mo>+</mo><mi>τ</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo>−</mo><mfrac><mi>α</mi><mi>α</mi></mfrac><mo>+</mo><mi>τ</mi></mrow></mfrac><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for </mtext><mspace width="0.333em"></mspace></mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
&amp; \gamma(0)=\sigma_{p l}^2 \frac{\Gamma(1-\alpha)}{\left(\Gamma\left(1-\frac{\alpha}{2}\right)\right)^2} \\
&amp; \gamma(\tau)=\frac{\frac{\alpha}{2}+\tau-1}{-\frac{\alpha}{\alpha}+\tau} \gamma(\tau-1) \text { for } \tau&gt;0
\end{aligned}
</annotation></semantics></math> When the argument
<code>stochastic_model</code> is set to <code>"wn + pl"</code>, the
stochastic model considered includes both white noise and power-law with
the specified above stationary autocovariance structure. The parameters
estimated are:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>W</mi><mi>N</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_{W N}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
(constrained to be greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>P</mi><mi>L</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_{P L}</annotation></semantics></math>.</p>
<p>When the argument <code>stochastic_model</code> is set to
<code>"wn + fl"</code>, the stochastic model considered includes both
white noise and flicker noise (not stationary power-law noise with a
spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa=-1</annotation></semantics></math>)
where the variance covariance of the flicker noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>
is obtained as follows (see e.g., <span class="citation">(Bos et al.
2008)</span>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Cov</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ω</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>σ</mi><mrow><mi>F</mi><mi>L</mi></mrow><mn>2</mn></msubsup><msup><mi>𝐔</mi><mi>T</mi></msup><mi>𝐔</mi></mrow><annotation encoding="application/x-tex">
\operatorname{Cov}(\omega) = \sigma^2_{F L}\mathbf{U}^T \mathbf{U}
</annotation></semantics></math></p>
<p>where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐔</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mn>0</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mi>n</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mn>0</mn></msub></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mo>⋱</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>h</mi><mn>0</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbf{U}=\left(\begin{array}{cccc}
h_0 &amp; h_1 &amp; \ldots &amp; h_n \\
0 &amp; h_0 &amp; &amp; h_{n-1} \\
\vdots &amp; &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \ldots &amp; h_0
\end{array}\right)
</annotation></semantics></math> with the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>i</mi></msub><annotation encoding="application/x-tex">h_i</annotation></semantics></math>
computed considering a spectral index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\kappa=-1</annotation></semantics></math>.</p>
<p>The stochastic parameters estimated are:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>W</mi><mi>N</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_{W N}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>F</mi><mi>L</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_{F L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
is fixed to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-of-estimation">Example of estimation<a class="anchor" aria-label="anchor" href="#example-of-estimation"></a>
</h2>
<p>Let us showcase how to estimate the tectonic velocity in for one
specific component (North, East or Vertical) of one station.</p>
<p>Let us first load the <code>gmwmx2</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SMAC-Group/gmwmx2" class="external-link">gmwmx2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-a-station-from-nevada-geodetic-laboratory">Download a station from Nevada Geodetic Laboratory<a class="anchor" aria-label="anchor" href="#download-a-station-from-nevada-geodetic-laboratory"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">station_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_station_ngl.html">download_station_ngl</a></span><span class="op">(</span><span class="st">"CHML"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-station">Plot Station<a class="anchor" aria-label="anchor" href="#plot-station"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">station_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_model_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="plot-northing-component">Plot Northing component<a class="anchor" aria-label="anchor" href="#plot-northing-component"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">station_data</span>, component <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_model_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="estimate-model-on-station-data">Estimate model on station data<a class="anchor" aria-label="anchor" href="#estimate-model-on-station-data"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gmwmx2.html">gmwmx2</a></span><span class="op">(</span><span class="va">station_data</span>, n_seasonal <span class="op">=</span> <span class="fl">2</span>, component <span class="op">=</span> <span class="st">"N"</span>, stochastic_model <span class="op">=</span> <span class="st">"wn + pl"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-estimated-parameters">Extract estimated parameters<a class="anchor" aria-label="anchor" href="#extract-estimated-parameters"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Summary of Estimated Model</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Functional parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Parameter                  Estimate  Std_Deviation  95% CI Lower  95% CI Upper</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Intercept               -0.70924596   0.00876879  -0.72643246  -0.69205945</span></span>
<span><span class="co">## Trend                    0.00007198   0.00000833   0.00005565   0.00008831</span></span>
<span><span class="co">## Sin (Annual)             0.00135377   0.00034179   0.00068387   0.00202367</span></span>
<span><span class="co">## Cos (Annual)            -0.00062838   0.00036176  -0.00133741   0.00008065</span></span>
<span><span class="co">## Sin (Semi-Annual)        0.00017180   0.00023845  -0.00029556   0.00063915</span></span>
<span><span class="co">## Cos (Semi-Annual)        0.00030877   0.00024595  -0.00017328   0.00079082</span></span>
<span><span class="co">## Jump: MJD 56248          0.01588617   0.00156627   0.01281633   0.01895601</span></span>
<span><span class="co">## Jump: MJD 55391          0.00780478   0.00153504   0.00479616   0.01081339</span></span>
<span><span class="co">## Jump: MJD 55563          0.00230763   0.00174920  -0.00112074   0.00573600</span></span>
<span><span class="co">## Jump: MJD 55603          0.00286880   0.00237791  -0.00179182   0.00752942</span></span>
<span><span class="co">## Jump: MJD 55606         -0.00044386   0.00351636  -0.00733580   0.00644808</span></span>
<span><span class="co">## Jump: MJD 56011         -0.00008945   0.00165713  -0.00333736   0.00315846</span></span>
<span><span class="co">## Jump: MJD 56085          0.00073436   0.00170239  -0.00260227   0.00407099</span></span>
<span><span class="co">## Jump: MJD 56748         -0.00038578   0.00139555  -0.00312101   0.00234945</span></span>
<span><span class="co">## Jump: MJD 57281         -0.00145742   0.00153903  -0.00447386   0.00155901</span></span>
<span><span class="co">## Earthquake: MJD 55391    0.01576163   0.00742010   0.00121850   0.03030476</span></span>
<span><span class="co">## Earthquake: MJD 55563    0.00174787   0.02573410  -0.04869004   0.05218579</span></span>
<span><span class="co">## Earthquake: MJD 55603   -0.28371260   0.53172586  -1.32587613   0.75845094</span></span>
<span><span class="co">## Earthquake: MJD 55606    0.27719703   0.52581943  -0.75339012   1.30778419</span></span>
<span><span class="co">## Earthquake: MJD 56011   -0.00480858   0.01325307  -0.03078411   0.02116696</span></span>
<span><span class="co">## Earthquake: MJD 56085   -0.00772227   0.01245006  -0.03212393   0.01667940</span></span>
<span><span class="co">## Earthquake: MJD 56748   -0.00910404   0.00542215  -0.01973126   0.00152318</span></span>
<span><span class="co">## Earthquake: MJD 57281   -0.02236505   0.00645616  -0.03501889  -0.00971122</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Stochastic parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  White Noise Variance  :     0.00000122</span></span>
<span><span class="co">##  Stationary powerlaw Spectral index:    -0.83907240</span></span>
<span><span class="co">##  Stationary powerlaw Variance:     0.00000336</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Missingness parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  P(Z_{i+1} = 0 | Z_{i} = 1): 0.00279460</span></span>
<span><span class="co">##  P(Z_{i+1} = 1 | Z_{i} = 0): 0.31578947</span></span>
<span><span class="co">##  \hat{E[Z]}: 0.99122807</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Running time: 0.79 seconds</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span></code></pre>
<p>By default, the estimated parameters are provided in m/day, we can
optionally scale the estimated functional parameters so that they are
returned in m/year with the argument <code>scale_parameters</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span>, scale_parameters <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Summary of Estimated Model</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Functional parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Parameter                  Estimate  Std_Deviation  95% CI Lower  95% CI Upper</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Intercept              -259.05208570   3.20279877 -265.32945595 -252.77471545</span></span>
<span><span class="co">## Trend                    0.02629027   0.00304291   0.02032629   0.03225426</span></span>
<span><span class="co">## Sin (Annual)             0.49446304   0.12483968   0.24978175   0.73914432</span></span>
<span><span class="co">## Cos (Annual)            -0.22951487   0.13213206  -0.48848895   0.02945921</span></span>
<span><span class="co">## Sin (Semi-Annual)        0.06274864   0.08709451  -0.10795347   0.23345075</span></span>
<span><span class="co">## Cos (Semi-Annual)        0.11277837   0.08983307  -0.06329122   0.28884795</span></span>
<span><span class="co">## Jump: MJD 56248          5.80242306   0.57208186   4.68116322   6.92368289</span></span>
<span><span class="co">## Jump: MJD 55391          2.85069445   0.56067178   1.75179795   3.94959095</span></span>
<span><span class="co">## Jump: MJD 55563          0.84286159   0.63889600  -0.40935155   2.09507473</span></span>
<span><span class="co">## Jump: MJD 55603          1.04782942   0.86853158  -0.65446120   2.75012003</span></span>
<span><span class="co">## Jump: MJD 55606         -0.16211875   1.28435053  -2.67939952   2.35516203</span></span>
<span><span class="co">## Jump: MJD 56011         -0.03267118   0.60526627  -1.21897127   1.15362890</span></span>
<span><span class="co">## Jump: MJD 56085          0.26822620   0.62179917  -0.95047779   1.48693018</span></span>
<span><span class="co">## Jump: MJD 56748         -0.14090556   0.50972464  -1.13994749   0.85813637</span></span>
<span><span class="co">## Jump: MJD 57281         -0.53232443   0.56212924  -1.63407749   0.56942863</span></span>
<span><span class="co">## Earthquake: MJD 55391    5.75693615   2.71019228   0.44505689  11.06881541</span></span>
<span><span class="co">## Earthquake: MJD 55563    0.63841028   9.39938149 -17.78403892  19.06085948</span></span>
<span><span class="co">## Earthquake: MJD 55603  -103.62602673 194.21287019 -484.27625764 277.02420417</span></span>
<span><span class="co">## Earthquake: MJD 55606  101.24621682 192.05554824 -275.17574076 477.66817439</span></span>
<span><span class="co">## Earthquake: MJD 56011   -1.75633307   4.84068270 -11.24389683   7.73123069</span></span>
<span><span class="co">## Earthquake: MJD 56085   -2.82055781   4.54738426 -11.73326718   6.09215156</span></span>
<span><span class="co">## Earthquake: MJD 56748   -3.32525134   1.98044104  -7.20684446   0.55634177</span></span>
<span><span class="co">## Earthquake: MJD 57281   -8.16883558   2.35811162 -12.79064944  -3.54702173</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Stochastic parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  White Noise Variance  :     0.00000122</span></span>
<span><span class="co">##  Stationary powerlaw Spectral index:    -0.83907240</span></span>
<span><span class="co">##  Stationary powerlaw Variance:     0.00000336</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Missingness parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  P(Z_{i+1} = 0 | Z_{i} = 1): 0.00279460</span></span>
<span><span class="co">##  P(Z_{i+1} = 1 | Z_{i} = 0): 0.31578947</span></span>
<span><span class="co">##  \hat{E[Z]}: 0.99122807</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Running time: 0.79 seconds</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plot-estimated-model">Plot estimated model<a class="anchor" aria-label="anchor" href="#plot-estimated-model"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_model_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gmwmx2.html">gmwmx2</a></span><span class="op">(</span><span class="va">station_data</span>, n_seasonal <span class="op">=</span> <span class="fl">2</span>, component <span class="op">=</span> <span class="st">"N"</span>, stochastic_model <span class="op">=</span> <span class="st">"wn + fl"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Summary of Estimated Model</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Functional parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Parameter                  Estimate  Std_Deviation  95% CI Lower  95% CI Upper</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Intercept               -0.70924596   0.01136945  -0.73152967  -0.68696225</span></span>
<span><span class="co">## Trend                    0.00007198   0.00001083   0.00005074   0.00009321</span></span>
<span><span class="co">## Sin (Annual)             0.00135377   0.00043414   0.00050287   0.00220467</span></span>
<span><span class="co">## Cos (Annual)            -0.00062838   0.00045622  -0.00152254   0.00026579</span></span>
<span><span class="co">## Sin (Semi-Annual)        0.00017180   0.00027821  -0.00037348   0.00071707</span></span>
<span><span class="co">## Cos (Semi-Annual)        0.00030877   0.00028861  -0.00025689   0.00087443</span></span>
<span><span class="co">## Jump: MJD 56248          0.01588617   0.00191916   0.01212469   0.01964764</span></span>
<span><span class="co">## Jump: MJD 55391          0.00780478   0.00182956   0.00421891   0.01139065</span></span>
<span><span class="co">## Jump: MJD 55563          0.00230763   0.00190189  -0.00142001   0.00603527</span></span>
<span><span class="co">## Jump: MJD 55603          0.00286880   0.00235741  -0.00175163   0.00748923</span></span>
<span><span class="co">## Jump: MJD 55606         -0.00044386   0.00358112  -0.00746272   0.00657500</span></span>
<span><span class="co">## Jump: MJD 56011         -0.00008945   0.00192695  -0.00386620   0.00368730</span></span>
<span><span class="co">## Jump: MJD 56085          0.00073436   0.00199984  -0.00318524   0.00465397</span></span>
<span><span class="co">## Jump: MJD 56748         -0.00038578   0.00187908  -0.00406870   0.00329714</span></span>
<span><span class="co">## Jump: MJD 57281         -0.00145742   0.00187987  -0.00514189   0.00222704</span></span>
<span><span class="co">## Earthquake: MJD 55391    0.01576163   0.00930876  -0.00248320   0.03400647</span></span>
<span><span class="co">## Earthquake: MJD 55563    0.00174787   0.02766816  -0.05248072   0.05597647</span></span>
<span><span class="co">## Earthquake: MJD 55603   -0.28371260   0.52755951  -1.31771024   0.75028504</span></span>
<span><span class="co">## Earthquake: MJD 55606    0.27719703   0.52174625  -0.74540682   1.29980089</span></span>
<span><span class="co">## Earthquake: MJD 56011   -0.00480858   0.01509158  -0.03438754   0.02477039</span></span>
<span><span class="co">## Earthquake: MJD 56085   -0.00772227   0.01454627  -0.03623244   0.02078791</span></span>
<span><span class="co">## Earthquake: MJD 56748   -0.00910404   0.00725836  -0.02333016   0.00512207</span></span>
<span><span class="co">## Earthquake: MJD 57281   -0.02236505   0.00811536  -0.03827086  -0.00645925</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Stochastic parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  White Noise Variance  :     0.00000193</span></span>
<span><span class="co">##  Flicker Noise Variance:     0.00000251</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Missingness parameters</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">##  P(Z_{i+1} = 0 | Z_{i} = 1): 0.00279460</span></span>
<span><span class="co">##  P(Z_{i+1} = 1 | Z_{i} = 0): 0.31578947</span></span>
<span><span class="co">##  \hat{E[Z]}: 0.99122807</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span>
<span><span class="co">## Running time: 0.86 seconds</span></span>
<span><span class="co">## -------------------------------------------------------------</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></code></pre></div>
<p><img src="fit_model_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bevis2014" class="csl-entry">
Bevis, Michael, and A. Brown. 2014. <span>“<span class="nocase">Trajectory Models and Reference Frames for Crustal Motion
Geodesy</span>.”</span> <em>Journal of Geodesy</em> 88 (283): 283--311.
</div>
<div id="ref-blewitt2024improved" class="csl-entry">
Blewitt, Geoffrey. 2024. <span>“<span class="nocase">An Improved
Equation of Latitude and a Global System of Graticule Distance
Coordinates</span>.”</span> <em>Journal of Geodesy</em> 98 (1): 6.
</div>
<div id="ref-blewitt2018harnessing" class="csl-entry">
Blewitt, Geoffrey, William Hammond, and Corn Kreemer. 2018. <span>“<span class="nocase">Harnessing the GPS Data Explosion for Interdisciplinary
Science</span>.”</span> <em>Eos</em> 99 (2): e2020943118.
</div>
<div id="ref-bos2008fast" class="csl-entry">
Bos, MS, RMS Fernandes, SDP Williams, and L Bastos. 2008. <span>“Fast
Error Analysis of Continuous GPS Observations.”</span> <em>Journal of
Geodesy</em> 82 (3): 157–66.
</div>
<div id="ref-bos2013fast" class="csl-entry">
———. 2013. <span>“<span class="nocase">Fast Error Analysis of Continuous
GNSS Observations with Missing Data</span>.”</span> <em>Journal of
Geodesy</em> 87 (4): 351–60.
</div>
<div id="ref-granger1980long" class="csl-entry">
Granger, Clive WJ. 1980. <span>“Long Memory Relationships and the
Aggregation of Dynamic Models.”</span> <em>Journal of Econometrics</em>
14 (2): 227–38.
</div>
<div id="ref-guerrier2013wavelet" class="csl-entry">
Guerrier, Stéphane, Jan Skaloud, Yannick Stebler, and Maria-Pia
Victoria-Feser. 2013. <span>“<span class="nocase">Wavelet-Variance-based
Estimation for Composite Stochastic Processes</span>.”</span>
<em>Journal of the American Statistical Association</em> 108 (503):
1021–30.
</div>
<div id="ref-he2017review" class="csl-entry">
He, Xiaoxing, Jean-Philippe Montillet, Rui Fernandes, Machiel Bos, Kegen
Yu, Xianghong Hua, and Weiping Jiang. 2017. <span>“<span class="nocase">Review of Current GPS Methodologies for Producing
Accurate Time Series and their Error Sources</span>.”</span> <em>Journal
of Geodynamics</em> 106: 12–29.
</div>
<div id="ref-hosking1981fractional" class="csl-entry">
Hosking, JRM. 1981. <span>“Fractional Differencing. Biometrika, 68 (1),
165–176.”</span>
</div>
<div id="ref-kasdin1992discrete" class="csl-entry">
Kasdin, N Jeremy, and Todd Walter. 1992. <span>“Discrete Simulation of
Power Law Noise (for Oscillator Stability Evaluation).”</span> In
<em>Proceedings of the 1992 IEEE Frequency Control Symposium</em>,
274–83. IEEE.
</div>
<div id="ref-langbein2008noise" class="csl-entry">
Langbein, John. 2008. <span>“<span class="nocase">Noise in GPS
Displacement Measurements from Southern California and Southern
Nevada</span>.”</span> <em>Journal of Geophysical Research: Solid
Earth</em> 113 (B5): 1–12. <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2007JB005247" class="external-link">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2007JB005247</a>.
</div>
<div id="ref-sobrero2020logarithmic" class="csl-entry">
Sobrero, Franco S, Michael Bevis, Demián D Gómez, and Fei Wang. 2020.
<span>“<span class="nocase">Logarithmic and Exponential Transients in
GNSS Trajectory Models as Indicators of Dominant Processes in
Postseismic Deformation</span>.”</span> <em>Journal of Geodesy</em> 94
(9): 84.
</div>
<div id="ref-voirol2024inference" class="csl-entry">
Voirol, Lionel, Haotian Xu, Yuming Zhang, Luca Insolia, Roberto
Molinari, and Stéphane Guerrier. 2024. <span>“<span class="nocase">Inference for Large Scale Regression Models with
Dependent Errors</span>.”</span> <em>arXiv Preprint
arXiv:2409.05160</em>.
</div>
<div id="ref-williams2004error" class="csl-entry">
Williams, Simon DP, Yehuda Bock, Peng Fang, Paul Jamason, Rosanne M
Nikolaidis, Linette Prawirodirdjo, Meghan Miller, and Daniel J Johnson.
2004. <span>“<span class="nocase">Error Analysis of Continuous GPS
Position Time Series</span>.”</span> <em>Journal of Geophysical
Research: Solid Earth</em> 109 (B3).
</div>
<div id="ref-xu2017study" class="csl-entry">
Xu, Haotian, Stéphane Guerrier, Roberto Molinari, and Yuming Zhang.
2017. <span>“<span class="nocase">A Study of the Allan Variance for
Constant-mean Nonstationary Processes</span>.”</span> <em>IEEE Signal
Processing Letters</em> 24 (8): 1257–60.
</div>
<div id="ref-zhang2008allan" class="csl-entry">
Zhang, Nien Fan. 2008. <span>“<span class="nocase">Allan Variance of
Time Series Models for Measurement Data</span>.”</span>
<em>Metrologia</em> 45 (5): 549.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lionel Voirol, Haotian Xu, Yuming Zhang, Luca Insolia, Roberto Molinari, Stéphane Guerrier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
